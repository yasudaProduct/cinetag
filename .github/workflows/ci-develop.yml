name: CI (develop)

on:
  push:
    branches:
      - develop

concurrency:
  group: ci-develop-${{ github.ref }} # ジョブの並行実行を防止するためのグループ名
  cancel-in-progress: true # 同じグループ内のジョブが実行中の場合、古いジョブをキャンセルする

jobs:
  # backend-unit-test は backend ディレクトリの単体テストを実行するジョブ
  backend-unit-test:
    name: backend / go test
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: apps/backend
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Go
        uses: actions/setup-go@v5
        with:
          go-version-file: apps/backend/go.mod
          cache-dependency-path: apps/backend/go.sum

      - name: Run unit tests
        run: go test ./...

  # frontend-check は frontend ディレクトリの lint と build を実行するジョブ
#   frontend-check:
#     name: frontend / lint + build
#     runs-on: ubuntu-latest
#     defaults:
#       run:
#         working-directory: apps/frontend
#     steps:
#       - name: Checkout
#         uses: actions/checkout@v4

#       - name: Setup Node.js
#         uses: actions/setup-node@v4
#         with:
#           node-version: "20"
#           cache: "npm"
#           cache-dependency-path: apps/frontend/package-lock.json

#       - name: Install deps
#         run: npm ci

#       - name: Lint
#         run: npm run lint

#       - name: Build
#         run: npm run build
